<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CÃ¢y TÃ¬nh YÃªu ðŸ’–</title>

<style>
body{
    margin:0;
    overflow:hidden;
    height:100vh;
    background:linear-gradient(to top,#fbc2eb,#a6c1ee);
}

#heartBtn{
    position:absolute;
    top:45%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:70px;
    cursor:pointer;
    z-index:10;
    animation:pulse 1.5s infinite;
    user-select:none;
}

@keyframes pulse{
    0%{transform:translate(-50%,-50%) scale(1)}
    50%{transform:translate(-50%,-50%) scale(1.2)}
    100%{transform:translate(-50%,-50%) scale(1)}
}

.fall{
    animation:drop 1.8s forwards ease-in;
}

@keyframes drop{
    to{ top:80%; }
}

canvas{
    position:absolute;
    top:0;
    left:0;
}
</style>
</head>

<body>

<div id="heartBtn">ðŸ’—</div>
<canvas id="canvas"></canvas>

<script>
const heartBtn = document.getElementById("heartBtn");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

heartBtn.addEventListener("click", startAnimation);
heartBtn.addEventListener("touchstart", startAnimation);

function startAnimation(){
    heartBtn.classList.add("fall");

    setTimeout(()=>{
        heartBtn.style.display="none";
        growTree();
    },1800);
}

function growTree(){

    let trunkHeight = 0;
    let maxHeight = 280;
    let centerX = canvas.width/2;
    let baseY = canvas.height*0.85;

    let grow = setInterval(()=>{

        ctx.clearRect(0,0,canvas.width,canvas.height);

        ctx.fillStyle="#5b2c16";
        ctx.fillRect(centerX-12, baseY-trunkHeight, 24, trunkHeight);

        ctx.beginPath();
        ctx.strokeStyle="#5b2c16";
        ctx.lineWidth=5;
        ctx.moveTo(centerX, baseY-trunkHeight+100);
        ctx.quadraticCurveTo(centerX-80, baseY-trunkHeight+40, centerX-120, baseY-trunkHeight);
        ctx.stroke();

        ctx.beginPath();
        ctx.moveTo(centerX, baseY-trunkHeight+120);
        ctx.quadraticCurveTo(centerX+80, baseY-trunkHeight+60, centerX+120, baseY-trunkHeight);
        ctx.stroke();

        trunkHeight+=3;

        if(trunkHeight>=maxHeight){
            clearInterval(grow);
            growFlowers(centerX, baseY-maxHeight);
        }

    },20);
}

function growFlowers(cx, topY){

    let points = [];
    let step = 0.08;
    let scale = 8;

    for(let t = 0; t < Math.PI*2; t += step){

        let x = 16*Math.pow(Math.sin(t),3);
        let y = 13*Math.cos(t)
              - 5*Math.cos(2*t)
              - 2*Math.cos(3*t)
              - Math.cos(4*t);

        for(let i=0;i<3;i++){
            points.push({
                x: cx + x*scale + (Math.random()*6-3),
                y: topY - y*scale + (Math.random()*6-3)
            });
        }
    }

    let index = 0;

    let bloom = setInterval(()=>{

        if(index >= points.length){
            clearInterval(bloom);
            return;
        }

        let flower = document.createElement("div");
        flower.innerHTML="ðŸ’–";
        flower.style.position="absolute";
        flower.style.fontSize="22px";
        flower.style.left = points[index].x + "px";
        flower.style.top  = points[index].y + "px";
        flower.style.opacity="0";
        flower.style.transform="scale(0)";
        flower.style.transition="0.4s ease";

        document.body.appendChild(flower);

        setTimeout(()=>{
            flower.style.opacity="1";
            flower.style.transform="scale(1)";
        },50);

        index++;

    },30); // tá»‘c Ä‘á»™ ná»Ÿ tá»« tá»«
}
</script>

</body>
</html>
